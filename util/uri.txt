Return-Path: <uri@snert.test>
Content-Type: multipart/mixed; boundary="--=_test_boundary"
Content-Transfer-Encoding: 7bit

----=_test_boundary
Content-Type: text/plain

The following test cases

-p -l -u -q	text
--------------------------------------------------------
 N  -  -  -	<>

 N  -  -  -	This is not a domain.

 Y  U  -  -	This sentence ends with the domain example.com. Is a reserved domain, not blacklisted (yet).

 Y  Y  N  -	"www.123.com."

 N  -  -  -	www.-123.com	Labels cannot start with a hyphen.

 N  -  -  -	www.123-.com	Labels cannot end with a hyphen.

 Y  U  N  -	'host.abc.com'

 Y  U  N  -	(smtp.abc.com)

 Y  U  N  -	'www.singlequote.com'

 Y  U  N  -	(www.parenthesis.com)

 N  -  -  -	There are no numeric top-level-domains like foo.bar.123

 N  -  -  -	foo.bar.-123		Invalid top-level-domain.

 N  -  -  -	foo.bar.123-		Invalid top-level-domain.

 N  -  -  -	foo.bar.1a2		Invalid top-level-domain.

 Y  U  -  -	cid:12345.67890@snert.com

 N  N  N  -	www.fail.test		Invalid top-level-domain.

 N  N  Y  -	www.pass.test		Invalid top-level-domain.

 N  N  N  -	www.anything.invalid	Invalid top-level-domain.

 N  N  N  -	www.anything.localhost	Invalid top-level-domain.

 Y  ?  N  -	http://127.0.0.1/

 Y  ?  Y  -	http://127.0.0.2/

 Y  N  N  -	https://www.snert.com/

 Y  N  N  -	http://samba.snert.com:901/

 Y  N  N  -	http://snert/  Many broswes and mail clients try default TLDs.

 Y  N  N  -	mailto:achowe@snert.com

 Y  U  N  -	remove@goldrush411.biz

 Y  U  N  -	fbfhbj5df33sdvbn8tg.com		Implicit short domain

 N  U  N  -	fbfhbj5df33sdvbn8tg.bogus	Should not be tested, invalid TLD

 Y  ?  Y  -	reachdirect.info		Implicit short domain

 N  ?  Y  -	reachdirect.bogus		Should not be tested, invalid TLD

 Y  Y  Y  Y	<http://translate.google.com/translate?u=www.fsl.com&langpair=en%7Cen&hl=en>

 Y  Y  Y  Y	http://autotrader.com/redirect/redirector_link.jsp?to_url=http://ic.fm0rt.com

 Y  Y  Y  Y	{http://ad.doubleclick.net/clk;29825968;12395550;w?http://www.bocajava.com/referral.do?promo=ediets0027text}

 Y  ?  Y  Y	http://rds.yahoo.com/S=8805213/K=computer/v=1/SID=a/l=WS1/R=1/SS=19512237/IPC=us/SHE=0/H=0/SIG=92qylAS97/EXP=020672989/*-http://xplrhto.s00p.net/

 Y  -  -  Y	http://dect.myspace.com/event.ng/Type=click&Redirect=http://pillenhaus.ch

 N  U  Y  -     Missing scheme //Maildir/tmp/1147912780.P18481.andromede.tetragone.fr

 N  -  -  -	https://smallbusiness..dell.com/	Double dot in domain.

 Y  ?  ?  Y     http://www.zdnetasia.com/search/results.htm?query=mari+misato+at+dynamix+%3CIFRAME%20src=//72.232.39.252/a/%3E.html

 Y  -  -  Y	http://www.google.com/pagead/iclk?sa=l&ai=EJVqDJ&num=65520&adurl=http://%73%6B%69%6E%61%70%70%6C%65%2E%63%6F%6D

 N  -  -  -	192.0.2.99

 N  -  -  -	2001:0DB8::1234

 N  -  -  -	2001:0DB8::192.0.2.99

 Y  -  -  -	http://[2001:0DB8::1234]:8008

 Y  -  -  -	http://[2001:0DB8::192.0.2.99]:8008

 Y  -  N  -	file://host/path/some/where

 Y  -  N  -	file:///path/any/where

 Y  -  N  -	file:///C|/windows/path

 Y  -  N  -	file:/path/not/here

 Y  -  N  -	file:path/not/rooted

 Y  -  -  -	about:

 N  -  -  - 	email:

 Y  -  -  - 	email:achowe@snert.com

 Y  -  -  -	mailto:scam@uribl.com

 Y  -  -  -	mailto:abuse@snert.com

 Y  -  N  -	&lt;wumpus@snert.org&gt;

----=_test_boundary
Content-Type: text/html
Content-Transfer-Encoding: quoted-printable

 Y  -  N  -	<a href=3D"mailto:user@ya=
hoo.ca">user</a> test soft newline handling

----=_test_boundary
Content-Type: text/html
Content-Transfer-Encoding: quoted-printable

 Y  -  N  -	<a href=3D"mailto:user@yahoo.=
ca">user</a> test soft newline handling

----=_test_boundary
Content-Type: text/html

 Y  -  N  -	<a href=http://www.snert.com/>Snert</a> no quotes around href value.

----=_test_boundary
Content-Type: text/plain

 Y  -  N  -	URI at start of line
blah blah
http://test.com

----=_test_boundary
Content-Type: text/plain; charset="ISO-2022-JP"

 Y  -  Y  -	URI prefixed by multibyte charset パソコン・携帯　http://www.c-evian.com

----=_test_boundary

 Y  -  N  -	URI at EOF without a newline http://no-newline.com/

----=_test_boundary
Content-type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Blair=2Ecom E-mail Specials=20
Quality, service and value since 1910=20
=20
=20
Meet our election winners!=20
Customers voted these styles tops - and now=20
you can get them at huge savings!=20
=20
Crested Mock Turtleneck=20
Item #35462=20
Was $9=2E99-$11=2E99  Now $3=2E99=20
http://www=2Eclickandoffer=2Ecom/l=2Easp?c=3Dm1009&r=3D9259y1&s=3D701&l=
=3D7&i=3D302028052&b=3D32508
=20

----=_test_boundary
Content-type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

URI with QP space at end of URI
http://oxakeysu.com=20

----=_test_boundary
Content-type: text/plain; charset=iso-8859-1

Should NOT match @token or @other word or @this

----=_test_boundary
Content-type: text/plain; charset=iso-8859-1

Should NOT parse the namespaceuri nor downloadurl attributes.
Note how they resemble SOME.DOMAIN-NAME:PORT, but should not
parse because the PORT is not numeric.

<o:SmartTagType =
namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"Street" =
downloadurl=3D"http://www.5iantlavalampft-com:office:smarttags"/>

----=_test_boundary
Content-type: text/plain; charset=iso-8859-1

Must not match anything.

$B$N%F%-%9%H$H2r@b$rF
%F%-%9%H$H8l6g$N2;@
hGO0&9%2H$+$i$NEEOC$,;&E~$7$F$$$k$H8@$C$F$$$k!
@h7nGO$r0z$-
$B8l6g$N@bL@
!D$@$1!
$B$*6b$@$1$G$9!
%i$R$H$j$@$1$G$O$J$$!
@A
$B5a=q$N;YJ'$$$K;M6lH,6l$7$F$$$k$H8@$C$F$$$k!
$B$$2H$,I,MW$@$H$$$&$3$H$@!
$@!

----=_test_boundary
Content-type: text/plain; charset=iso-8859-1

URL encoded punctuation including email query string.

 Y  ?  ?  Y	http%3A%2F%2Fwww%2Ecyberlink%2Ecom%2Fmulti%2Fedm%2Funsubscribe%2Ejsp%3FEmail%3Dmandtchristie@activ8.net.au

URL encoded punctuation including double redirection and email query string.

 Y  ?  ?  ?	http%3A%2F%2Fwww%2Ecyberlink%2Ecom%2Fenglish%2Fdownload%2Faffiliate%2Ejsp%3Fclid%3D2581%5F603%5F11%5FBronze1login1108%5F0%26RedirectURL%3Dhttps%253A%2F%2Fmembership%2Ecyberlink%2Ecom%2Fenglish%2Fmembership%5Fprogram%2Fmember%5Farea%2Fpersonal%5Fprofile%2Ejsp%3FEmail%3Dmandtchristie@activ8.net.au

----=_test_boundary
Content-Transfer-Encoding: quoted-printable
Content-type: text/plain; charset=iso-8859-1
Comment: test QP soft-line breaks in middle of URL;
	also inverted order of Content-Type and Content-Transfer-Encoding

  <a href=3D"http://SKedbjjcffmjcDM=2Ejollaface=2Ecom/t=
=2Easp=3Fa=3Dc&u=3D202717573&s=3D2129&e=3D43199255">=0A

----=_test_boundary
Content-type: text/plain; charset="koi8-r"
Content-Transfer-Encoding: quoted-printable
Comment: Russian encoded URL doesn't parse correctly, since
	 RFC 3986 excludes octets with the high bit from a URI.

 N  -  N  -	http://www.f=C1v=CFrit=C5-s=C5ri=C1ls.ru/

----=_test_boundary
Content-type: text/plain; charset=iso-8859-1
Comment: expect to find dfg@fsg.com

Header-ending-with-URI: dfg@fsg.com
Next-Header: make sure URI at end of line and Next-Header are separate

----=_test_boundary
Content-type: text/plain
Content-transfer-encoding: BASE64
Content-disposition: inline
Comment: source newline should not flush decode buffer
	 expect http://sedona.arizona.bestcareerin.com/TO12O179O3272674
	 expect http://summerbay.resorts.bestcareerin.com/ZO8O179O3272674

U2Vkb25hIEFyaXpvbmEgQXdhaXRzICBFbmpveSBhIDIgTmlnaHQgU3RheSEgCjxodHRwOi8v
c2Vkb25hLmFyaXpvbmEuYmVzdGNhcmVlcmluLmNvbS9UTzEyTzE3OU8zMjcyNjc0PgoKU2Vl
IGJlYXV0aWZ1bCBSZWQgUm9jayBDb3VudHJ5IHdpdGggdGhpcyBsaW1pdGVkICB0aW1lIHBy
b21vdGlvbiBjb21wbGltZW50cyBvZiBTdW1tZXIgQmF5IFJlc29ydC4gIAoKTm8gcHVyY2hh
c2UgcmVxdWlyZWQgIEFjY2VzcyB0byBvdXIgVG9sbCBGcmVlIHJlc2VydmF0aW9ucyEgIAoK
CgoKCgoKCgoKCgoKCgoKCgpTdW1tZXIgQmF5IFJlc29ydHMgYXQgNDA0NCBXLiBMYWtlIE1h
cnkgQmx2ZC4sIFVuaXQgIzEwNC00MTkgTGFrZSBNYXJ5LCBGTCAzMjc0Ni0yMDEyClNheSBn
b29kIGJ5ZSB0byBvdXIgbWVzc2FnZXMKaHR0cDovL3N1bW1lcmJheS5yZXNvcnRzLmJlc3Rj
YXJlZXJpbi5jb20vWk84TzE3OU8zMjcyNjc0CgoKCiJHb2QgY3JlYXRlZCB0aGUgR3JhbmQg
Q2FueW9uIGluIDcgZGF5cywgYnV0IGhlIGxpdmVzIGluIFNlZG9uYS4iIC0tIGxvY2FsIHNh
eWluZyBmcm9tIG5hdGl2ZXMuCkNoYW5nZSB5b3VyIG1pbmQ/CjxodHRwOi8vc2Vkb25hLmFy
aXpvbmEuYmVzdGNhcmVlcmluLmNvbS9UTzEyTzE3OU8zMjcyNjc0PgoKCgoKCg==

----=_test_boundary
Content-type: text/plain
Comment: The string belowe decordes to...
	 document.write(unescape('<FORM name=affiliateForm onsubmit=\"return fara_date();\" action=http://213.210.237.83/webscr/cmd/protect_files/yassino-file.php method=post>'));

document.write(unescape('%3C%46%4F%52%4D%20%6E%61%6D%65%3D%61%66%66%69%6C%69%61%74%65%46%6F%72%6D%20%6F%6E%73%75%62%6D%69%74%3D%22%72%65%74%75%72%6E%20%66%61%72%61%5F%64%61%74%65%28%29%3B%22%20%61%63%74%69%6F%6E%3D%68%74%74%70%3A%2F%2F%32%31%33%2E%32%31%30%2E%32%33%37%2E%38%33%2F%77%65%62%73%63%72%2F%63%6D%64%2F%70%72%6F%74%65%63%74%5F%66%69%6C%65%73%2F%79%61%73%73%69%6E%6F%2D%66%69%6C%65%2E%70%68%70%20%6D%65%74%68%6F%64%3D%70%6F%73%74%3E'));

----=_test_boundary
Content-type: text/plain
Comment: Problem in parsing implicit URL with a path and query parts.

 Y  -  -  -	www.newtwix.org/twixtel42/?portofrei

----=_test_boundary
Content-type: text/plain
Comment: Underscore is not part of domain/host name.

 Y  -  -  -	___geegeesoe.com___

----=_test_boundary
Content-type: text/plain
Comment: URL obfuscation using HTML entity &shy; (soft-hyphen)

http://e&shy;&shy;x&shy;&shy;a&shy;&shy;m&shy;p&shy;l&shy;e&shy;&shy;.&shy;&shy;com/zT7btk1qlUMjBX10001aqyykbtlqvi/VJ4TBBE9203/hN6foQ
http://e&shy;&shy;x&shy;&shy;a&shy;&shy;m&shy;p&shy;l&shy;e&shy;&shy;.&shy;&shy;com/foo?a=&#128;&q=&quot;

----=_test_boundary--


